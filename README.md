# Module-Link for Cockpit CMS

**This repository is archived and not maintained anymore.**

---

**This addon is not compatible with Cockpit CMS v2.**

See also [Cockpit CMS v1 docs](https://v1.getcockpit.com/documentation), [Cockpit CMS v1 repo](https://github.com/agentejo/cockpit) and [Cockpit CMS v2 docs](https://getcockpit.com/documentation/), [Cockpit CMS v2 repo](https://github.com/Cockpit-HQ/Cockpit).

---

ModuleLink Field for [Cockpit CMS](https://github.com/agentejo/cockpit)

This addon is experimental and I'm not sure, if or when I'll work on it again.

## Installation

Copy this repository into `/addons` and name it `ModuleLink` or

```bash
cd path/to/cockpit
git clone https://github.com/raffaelj/cockpit_ModuleLink.git addons/ModuleLink
```

## Usage

Create a new collection with a modulelink field

**Do not name a field "link".** Weird things may happen, see also: [#590](https://github.com/agentejo/cockpit/issues/590). The issue was closed, but it still happens, even without the ModuleLink addon.

## Field Options

```json
{
  "module": "collections"
}
```

or:

```json
{
  "module": "collections",
  "filter": {
    "type": "foo",
    "color": "#FFCE54"
  },
  "display": "_id"
}
```

**filter default:** all entries, values must match exact

**display default:** label || name

## Request

`https://url.to/cockpit/api/collections/get/collectionname?token=xxtoktenxx`

to populate nested module links add:

```json
{
  "populate":"nonsense",
  "populate_module":"1"
}
```

"populate" must exist to trigger the custom _populate function. `"populate":"0"` would cause false too early, but `"populate":"anystring"` is a small hack to still call the method without resolving collection-links.

**Be careful with populating too deep** if you link in circles. You could produce endless loops...

## Output

without population:

```json
    "entries": [
        {
            "mod": [
                {
                    "_id": "modulelinktest5baf427461f97",
                    "name": "modulelinktest",
                    "module": "collections",
                    "display": "modulelinktest"
                }
            ],
            "collectionlink": {
                "_id": "5b771cb933386215c4000193",
                "link": "pages",
                "display": "test no slug"
            },
            "_mby": "5b0fb863a1e1cdoc1879762079",
            "_by": "5b0fb863a1e1cdoc1879762079",
            "_modified": 1538414489,
            "_created": 1538414361,
            "_id": "5bb257193338620a54000092"
        }
    ]
```

## Screenshots

![modulelink01](https://user-images.githubusercontent.com/13042193/46308476-0bf51480-c5ba-11e8-84ab-0d75ec02d633.png)

![modulelink02](https://user-images.githubusercontent.com/13042193/46308478-0bf51480-c5ba-11e8-80cb-075ca388f8f9.png)
